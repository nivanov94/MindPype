

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basic Setup &mdash; mindpype 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced Setup" href="AdvancedSetup.html" />
    <link rel="prev" title="Before Using MindPype" href="before.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            mindpype
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Getting Started with MindPype</a></li>
<li class="toctree-l1"><a class="reference internal" href="before.html">Before Using MindPype</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Basic Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-session">Creating a Session</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-graph">Creating a Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-input-data">Creating input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-data-to-mindpype-type">Converting data to MindPype type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-outputs">Defining outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-nodes">Creating Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#verifying-a-graph">Verifying a graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#initializing-the-graph">Initializing the graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executing-a-graph">Executing a graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="#execution-with-epochs-known-labels">Execution with epochs, known labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#execution-with-continuous-data-unknown-labels">Execution with continuous data, unknown labels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AdvancedSetup.html">Advanced Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindpype.html">MindPype Package Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindpype.kernels.html">List of available kernels</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mindpype</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Basic Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/BasicSetup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="basic-setup">
<h1>Basic Setup<a class="headerlink" href="#basic-setup" title="Link to this heading"></a></h1>
<p><strong>The following guide will walkthrough the creation of a basic processing graph.</strong></p>
<section id="creating-a-session">
<h2>Creating a Session<a class="headerlink" href="#creating-a-session" title="Link to this heading"></a></h2>
<p>The usage of the MindPype library is based on sessions, that is, a particular processing session. A Session object must be instantiated before building or executing a processing graph. Sessions are instantiated using the following syntax:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">example_session</span> <span class="o">=</span> <span class="n">Session</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="creating-a-graph">
<h2>Creating a Graph<a class="headerlink" href="#creating-a-graph" title="Link to this heading"></a></h2>
<p>Once the session has been defined, the trial graph(s) to conduct the processing must be created.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trial_graph</span> <span class="o">=</span> <span class="n">Graph</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">example_session</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-input-data">
<h2>Creating input data<a class="headerlink" href="#creating-input-data" title="Link to this heading"></a></h2>
<p>Next, the location of your input data and training data should be provided. Trial Input data is most commonly
provided with an LSL stream (for online processing), or a MAT file (for batch processing);
while training data is most often provided either as a MAT file or the output of a execution (as a circle buffer/tensor object).
It may be easiest to understand the function of the MindPype library using a MAT File input for input and training data. There are 3
types of MAT file inputs to be used for trial inputs, depending on how the data is organized. The epoched mat input is for MAT data that is separated by trial,
the class separated mat input is for data that is separated by class, and the continuous data mat input is for continuous data (raw eeg input).
For this setup, we’ll use continuous data for the input data, and a generic Tensor with mat data for the initialization data,
and use the following code to create the input/training data objects:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_data</span> <span class="o">=</span> <span class="n">BcipContinuousMat</span><span class="o">.</span><span class="n">create_continuous</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;input_data&#39;</span><span class="p">,</span> <span class="s1">&#39;input_labels&#39;</span><span class="p">,</span> <span class="s1">&#39;test_data\input_data.mat&#39;</span><span class="p">,</span> <span class="s1">&#39;test_data\input_labels.mat&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_data</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;test_data\init_data.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;init_data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_labels</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;test_data\init_labels.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#500 is the trial duration, 0 is the first sample of the data to be used, 4000 is the last sample, and 0 is the relative start</span>
</pre></div>
</div>
</section>
<section id="converting-data-to-mindpype-type">
<h2>Converting data to MindPype type<a class="headerlink" href="#converting-data-to-mindpype-type" title="Link to this heading"></a></h2>
<p>In the below step, it is critical to remember that inputs and outputs to graph/node must be a MindPype built-in type
(Tensor, Array, or Scalar depending on the specific nodes being used), for both training data and trial data. Thus, we’ll
transform the input and training data to Tensors. For the input data, we’ll create a Tensor from a “handle”, which simply
means that it will be updated between trials from an external data source (the MAT file we imported), while the training
data is a Tensor we create from data and doesn’t need to be modified/polled.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_data</span> <span class="o">=</span> <span class="n">Tensor</span><span class="o">.</span><span class="n">create_from_handle</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="n">input_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_data_tensor</span> <span class="o">=</span> <span class="n">Tensor</span><span class="o">.</span><span class="n">create_from_data</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">init_data</span><span class="p">),</span> <span class="n">init_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_labels_tensor</span> <span class="o">=</span> <span class="n">Tensor</span><span class="o">.</span><span class="n">create_from_data</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">init_labels</span><span class="p">),</span><span class="n">init_labels</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="defining-outputs">
<h2>Defining outputs<a class="headerlink" href="#defining-outputs" title="Link to this heading"></a></h2>
<p>Along with the input and training data, we also need to define an output data object (to store the result of the processing graph), and edge object (which connect nodes/processing elements together). For this example, our last kernel will be a classifier (and its output a scalar), so we can define an output with the following:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">Scalar</span><span class="o">.</span><span class="n">create_from_value</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="creating-nodes">
<h2>Creating Nodes<a class="headerlink" href="#creating-nodes" title="Link to this heading"></a></h2>
<p>This example will contain 3 nodes (a temporal filter, a CSP node, and an LDA classifier), thus, we will need 2 edges (think data holder</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">edges_to_connect_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Tensor</span><span class="o">.</span><span class="n">create_virtual</span><span class="p">(</span><span class="n">session</span><span class="p">),</span> <span class="n">Tensor</span><span class="o">.</span><span class="n">create_virtual</span><span class="p">(</span><span class="n">session</span><span class="p">)]</span>
</pre></div>
</div>
<p>Once the edges have been created, nodes (processing elements) can be added to the graph. Nodes are the objects that get added to the graph, but nodes contain kernels, which are objects that conduct the data processing. To create a filter node and add it to the graph, use the following syntax:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filter_object</span> <span class="o">=</span> <span class="n">Filter</span><span class="o">.</span><span class="n">create_butter</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="mi">4</span><span class="p">,(</span><span class="mi">8</span><span class="p">,</span><span class="mi">35</span><span class="p">),</span><span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span><span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># see filter class for parameter explanation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FilterKernel</span><span class="o">.</span><span class="n">add_filter_node</span><span class="p">(</span><span class="n">trial_graph</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">filter_object</span><span class="p">,</span> <span class="n">edges_to_connect_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># where input_data is the input to the node, filter_object is the specific filter that will conduct the processing, and edges_to_connect_nodes[0] is the Tensor where the output will be stored</span>
</pre></div>
</div>
<p>In a similar fashion, we can add our CSP and LDA Classifier Nodes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CommonSpatialPatternKernel</span><span class="o">.</span><span class="n">add_uninitialized_CSP_node</span><span class="p">(</span><span class="n">trial_graph</span><span class="p">,</span> <span class="n">edges_to_connect_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edges_to_connect_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">training_data_tensor</span><span class="p">,</span> <span class="n">training_labels_tensor</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lda_object</span> <span class="o">=</span> <span class="n">Classifier</span><span class="o">.</span><span class="n">create_LDA</span><span class="p">(</span><span class="n">session</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ClassifierKernel</span><span class="o">.</span><span class="n">add_classifier_node</span><span class="p">(</span><span class="n">trial_graph</span><span class="p">,</span> <span class="n">edges_to_connect_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lda_object</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above line, we set the training_data/labels input parameters to None. This is an important feature to remember about the MindPype library;
if training data is provided for some upstream node (in this graph, the CSP node), the library will automatically compute the training data for
downstream nodes. If we wanted, we could’ve passed different training data, but opted not to for this example.</p>
</section>
<section id="verifying-a-graph">
<h2>Verifying a graph<a class="headerlink" href="#verifying-a-graph" title="Link to this heading"></a></h2>
<p>Once the graph is built, the next step is to have it verified. Verification will schedule nodes, ensure that inputs and outputs
are the correct shape and type, and will determine whether any nodes are missing training data. This process can be started with a single command:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trial_graph</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="initializing-the-graph">
<h2>Initializing the graph<a class="headerlink" href="#initializing-the-graph" title="Link to this heading"></a></h2>
<p>The last step before we can use the graph is to have it initialized, which will initialize each node within the graph (train, compute filters, etc):
this process can also be started with one command:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trial_graph</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="executing-a-graph">
<h2>Executing a graph<a class="headerlink" href="#executing-a-graph" title="Link to this heading"></a></h2>
<p>At this stage, the graph is ready to process data. During execution, we have a number of options, so we must first ask ourselves a number of questions.</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Do the trials you’re executing have a defined structure?</dt><dd><ul class="simple">
<li><p>If yes, it may be useful to define a trial_set before execution</p></li>
<li><p>If not, it is assumed that you’ll be executing trials indefinitely (ie. P300 speller setup)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Do you know the class labels of the trials you’re executing. For example, in some mental imagery experiments, we know what action will be completed before it occurs.</dt><dd><ul class="simple">
<li><p>If yes, you will not be able to use continuous data for this. You should use class separated / epoched data instead. At that point, you’ll be able to call execute like:</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">execution_status</span> <span class="o">=</span> <span class="n">trial_graph</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">class_label</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="execution-with-epochs-known-labels">
<h2>Execution with epochs, known labels<a class="headerlink" href="#execution-with-epochs-known-labels" title="Link to this heading"></a></h2>
<p>If you were to use epoched data and a trial set, we could define a trial set using standard Python syntax:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trial_seq</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="c1">#4 trials of class 0, 4 of class 1</span>
</pre></div>
</div>
<p>Based on the provided data (4000 samples, each trial lasting 500 samples), we already know that only 8 trials can occur, so we can loop through the trial set like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">t_num</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
<span class="go">        y = trial_seq[t_num]</span>
<span class="go">        try:</span>
<span class="go">            trial_graph.execute(y)</span>
<span class="go">            t_num += 1</span>
<span class="go">            y_bar = s_out.data</span>
<span class="go">            print(&quot;Trial {}: Predicted label = {}&quot;.format(t_num+1,y_bar))</span>
<span class="go">        except Exception as e:</span>
<span class="go">            print(f&quot;Trial {t_num+1} raised error: {e}&quot;)</span>
</pre></div>
</div>
<p><strong>Remember, this will only work with class separated/epoched data, not continuous mat data</strong></p>
</section>
<section id="execution-with-continuous-data-unknown-labels">
<h2>Execution with continuous data, unknown labels<a class="headerlink" href="#execution-with-continuous-data-unknown-labels" title="Link to this heading"></a></h2>
<p>If we were to use continuous data and no class labels (ie. P300) we could loop through in a similar way, but execute trials without labels.
<strong>Remember, this only works with continuous data, labels are required for epoched/class separated data</strong></p>
<p>Based on the input data, we still know only 8 trials will occur, so we could use the following code.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">t_num</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
<span class="go">        try:</span>
<span class="go">            trial_graph.execute()</span>
<span class="go">            t_num += 1</span>
<span class="go">            y_bar = s_out.data</span>
<span class="go">            print(&quot;Trial {}: Predicted label = {}&quot;.format(t_num+1,y_bar))</span>
<span class="go">        except Exception as e:</span>
<span class="go">            print(f&quot;Trial {t_num+1} raised error: {e}&quot;)</span>
</pre></div>
</div>
<p>This concludes the setup guide, please see the other documentation, or examples available in our github repo for more examples/test scripts.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="before.html" class="btn btn-neutral float-left" title="Before Using MindPype" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="AdvancedSetup.html" class="btn btn-neutral float-right" title="Advanced Setup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Nicolas Ivanov, Aaron Lio, Maddie Wong.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>